2026-01-14 23:58:59 | INFO     | __main__:setup_logging:61 | Logging to: ../targeted_analysis/20260114/7592606636217257238/analysis.log
2026-01-14 23:58:59 | INFO     | __main__:main:103 | ======================================================================
2026-01-14 23:58:59 | INFO     | __main__:main:104 | TARGETED VIDEO ANALYSIS - SINGLE VIDEO
2026-01-14 23:58:59 | INFO     | __main__:main:105 | ======================================================================
2026-01-14 23:58:59 | INFO     | __main__:main:106 | URL: https://vm.tiktok.com/ZNRkJrjbj/
2026-01-14 23:58:59 | INFO     | __main__:main:107 | Video ID: 7592606636217257238
2026-01-14 23:58:59 | INFO     | __main__:main:108 | Product: Video_Analysis_04
2026-01-14 23:58:59 | INFO     | __main__:main:109 | Output: ../targeted_analysis/20260114/7592606636217257238
2026-01-14 23:58:59 | INFO     | __main__:main:110 | ======================================================================
2026-01-14 23:58:59 | INFO     | targeted_analysis.metadata_extractor:extract_metadata_and_download:269 | === PHASE 1: METADATA EXTRACTION ===
2026-01-14 23:58:59 | INFO     | targeted_analysis.metadata_extractor:extract_metadata_and_download:270 | URL: https://vm.tiktok.com/ZNRkJrjbj/
2026-01-14 23:58:59 | INFO     | targeted_analysis.metadata_extractor:extract_metadata_and_download:272 | Product: Video_Analysis_04
2026-01-14 23:58:59 | DEBUG    | targeted_analysis.metadata_extractor:extract_video_id:43 | URL appears to be a short link, using yt-dlp to resolve
2026-01-14 23:59:01 | INFO     | targeted_analysis.metadata_extractor:extract_video_id:54 | Resolved short URL to video ID: 7592606636217257238
2026-01-14 23:59:01 | INFO     | targeted_analysis.metadata_extractor:fetch_metadata:78 | Fetching metadata for video ID: 7592606636217257238
2026-01-14 23:59:10 | SUCCESS  | targeted_analysis.metadata_extractor:fetch_metadata:118 | Metadata fetched: nawabzil512 | 14.0s | 363600 views
2026-01-14 23:59:10 | DEBUG    | targeted_analysis.metadata_extractor:extract_video_id:43 | URL appears to be a short link, using yt-dlp to resolve
2026-01-14 23:59:12 | INFO     | targeted_analysis.metadata_extractor:extract_video_id:54 | Resolved short URL to video ID: 7592606636217257238
2026-01-14 23:59:12 | INFO     | targeted_analysis.metadata_extractor:download_video:175 | Downloading video ID: 7592606636217257238 to ../targeted_analysis/20260114/7592606636217257238
2026-01-14 23:59:23 | SUCCESS  | targeted_analysis.metadata_extractor:download_video:231 | Video downloaded: video.mp4 (1.9MB, 15.0s)
2026-01-14 23:59:23 | SUCCESS  | targeted_analysis.metadata_extractor:extract_metadata_and_download:288 | Metadata saved to: ../targeted_analysis/20260114/7592606636217257238/metadata.json
2026-01-14 23:59:23 | SUCCESS  | targeted_analysis.metadata_extractor:extract_metadata_and_download:290 | ✅ PHASE 1 COMPLETE
2026-01-14 23:59:23 | INFO     | targeted_analysis.frame_processor:extract_frames_audio_and_transcribe:390 | === PHASE 2: FRAME + AUDIO EXTRACTION + TRANSCRIPTION ===
2026-01-14 23:59:23 | INFO     | targeted_analysis.frame_processor:extract_keyframes_and_audio:54 | Extracting keyframes (every 2s) and audio...
2026-01-14 23:59:23 | DEBUG    | targeted_analysis.frame_processor:extract_keyframes_and_audio:69 | Video duration: 14.97s
2026-01-14 23:59:24 | SUCCESS  | targeted_analysis.frame_processor:extract_keyframes_and_audio:96 | Audio extracted: audio.mp3
2026-01-14 23:59:24 | SUCCESS  | targeted_analysis.frame_processor:extract_keyframes_and_audio:104 | Extracted 7 frames (15.0s ÷ 2s) and audio
2026-01-14 23:59:24 | INFO     | targeted_analysis.frame_processor:get_transcript:321 | === Transcript Extraction (Hybrid Approach) ===
2026-01-14 23:59:24 | INFO     | targeted_analysis.frame_processor:get_tiktok_captions:122 | Attempting to fetch TikTok captions...
2026-01-14 23:59:27 | INFO     | targeted_analysis.frame_processor:get_tiktok_captions:147 | No TikTok captions found
2026-01-14 23:59:27 | INFO     | targeted_analysis.frame_processor:transcribe_audio_fallback:265 | Transcribing audio with Whisper (fallback method)...
2026-01-14 23:59:27 | INFO     | targeted_analysis.frame_processor:get_whisper_model:32 | Loading Whisper tiny model (cached for batch processing)...
2026-01-14 23:59:28 | SUCCESS  | targeted_analysis.frame_processor:get_whisper_model:34 | Whisper model loaded
2026-01-14 23:59:30 | SUCCESS  | targeted_analysis.frame_processor:transcribe_audio_fallback:299 | Whisper transcription complete: 7 segments, language=en (1.00)
2026-01-14 23:59:30 | SUCCESS  | targeted_analysis.frame_processor:extract_frames_audio_and_transcribe:403 | Transcript saved to: ../targeted_analysis/20260114/7592606636217257238/transcript.json
2026-01-14 23:59:30 | SUCCESS  | targeted_analysis.frame_processor:extract_frames_audio_and_transcribe:405 | ✅ PHASE 2 COMPLETE
2026-01-14 23:59:30 | INFO     | targeted_analysis.frame_processor:extract_frames_audio_and_transcribe:406 |    Frames: 7 frames in ../targeted_analysis/20260114/7592606636217257238/frames
2026-01-14 23:59:30 | INFO     | targeted_analysis.frame_processor:extract_frames_audio_and_transcribe:407 |    Audio: ../targeted_analysis/20260114/7592606636217257238/audio.mp3
2026-01-14 23:59:30 | INFO     | targeted_analysis.frame_processor:extract_frames_audio_and_transcribe:408 |    Transcript: whisper_transcription (en, 7 segments)
2026-01-14 23:59:30 | INFO     | __main__:main:161 | ======================================================================
2026-01-14 23:59:30 | INFO     | __main__:main:162 | PHASE 3: COMPREHENSIVE ANALYSIS (4 parts)
2026-01-14 23:59:30 | INFO     | __main__:main:163 | ======================================================================
2026-01-14 23:59:30 | INFO     | targeted_analysis.analyzers.structural:analyze_structural:35 | === Phase 3A: Structural Analysis ===
2026-01-14 23:59:30 | INFO     | targeted_analysis.analyzers.structural:analyze_structural:105 | Calling Gemini with 7 frames...
2026-01-15 00:01:02 | WARNING  | targeted_analysis.analyzers.structural:analyze_structural:127 | gemini-3-pro failed, trying flash model: Loaded cached credentials.
Server 'filesystem' supports tool updates. Listening for changes...
Server 'context7' supports tool updates. Listening for changes...
Server 'sequential-thinking' supports tool updates. Listening for changes...
Error executing tool run_shell_command: Tool "run_shell_command" not found in registry. Tools must use the exact names that are registered. Did you mean one of: "search_file_content", "convert_time", "read_file"?
Error executing tool list_directory: Path must be within one of the workspace directories: /Users/lxt/Movies/TikTok/WZ/lukas_9688/scripts
Error executing tool list_allowed_directories: Tool execution for "list_allowed_directories (filesystem MCP Server)" denied by policy.
Error executing tool read_media_file: Tool execution for "read_media_file (filesystem MCP Server)" denied by policy.
Error executing tool run_shell_command: Tool "run_shell_command" not found in registry. Tools must use the exact names that are registered. Did you mean one of: "search_file_content", "convert_time", "read_file"?
Error when talking to Gemini API Full report available at: /var/folders/kt/j2l9r3892f1__8kc19n9dff00000gp/T/gemini-client-error-Turn.run-sendMessageStream-2026-01-14T23-01-02-025Z.json TerminalQuotaError: You have exhausted your capacity on this model. Your quota will reset after 14h59m21s.
    at classifyGoogleError (file:///Users/lxt/.nvm/versions/node/v23.8.0/lib/node_modules/@google/gemini-cli/node_modules/@google/gemini-cli-core/dist/src/utils/googleQuotaErrors.js:136:28)
    at retryWithBackoff (file:///Users/lxt/.nvm/versions/node/v23.8.0/lib/node_modules/@google/gemini-cli/node_modules/@google/gemini-cli-core/dist/src/utils/retry.js:127:37)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async GeminiChat.makeApiCallAndProcessStream (file:///Users/lxt/.nvm/versions/node/v23.8.0/lib/node_modules/@google/gemini-cli/node_modules/@google/gemini-cli-core/dist/src/core/geminiChat.js:364:32)
    at async GeminiChat.streamWithRetries (file:///Users/lxt/.nvm/versions/node/v23.8.0/lib/node_modules/@google/gemini-cli/node_modules/@google/gemini-cli-core/dist/src/core/geminiChat.js:225:40)
    at async Turn.run (file:///Users/lxt/.nvm/versions/node/v23.8.0/lib/node_modules/@google/gemini-cli/node_modules/@google/gemini-cli-core/dist/src/core/turn.js:64:30)
    at async GeminiClient.processTurn (file:///Users/lxt/.nvm/versions/node/v23.8.0/lib/node_modules/@google/gemini-cli/node_modules/@google/gemini-cli-core/dist/src/core/client.js:440:26)
    at async GeminiClient.sendMessageStream (file:///Users/lxt/.nvm/versions/node/v23.8.0/lib/node_modules/@google/gemini-cli/node_modules/@google/gemini-cli-core/dist/src/core/client.js:536:20)
    at async file:///Users/lxt/.nvm/versions/node/v23.8.0/lib/node_modules/@google/gemini-cli/dist/src/nonInteractiveCli.js:192:34
    at async main (file:///Users/lxt/.nvm/versions/node/v23.8.0/lib/node_modules/@google/gemini-cli/dist/src/gemini.js:452:9) {
  cause: {
    code: 429,
    message: 'You have exhausted your capacity on this model. Your quota will reset after 14h59m21s.',
    details: [ [Object], [Object] ]
  },
  retryDelayMs: 53961030.234187
}
An unexpected critical error occurred:[object Object]

2026-01-15 00:01:57 | SUCCESS  | targeted_analysis.analyzers.structural:analyze_structural:132 | Structural analysis complete (fallback model)
2026-01-15 00:01:57 | INFO     | targeted_analysis.analyzers.content:analyze_content:34 | === Phase 3B: Content Analysis ===
2026-01-15 00:01:57 | INFO     | targeted_analysis.analyzers.content:analyze_content:134 | Calling Gemini for content analysis...
2026-01-15 00:02:12 | WARNING  | targeted_analysis.analyzers.content:analyze_content:153 | Trying flash model: Loaded cached credentials.
Server 'filesystem' supports tool updates. Listening for changes...
Serve
2026-01-15 00:02:43 | SUCCESS  | targeted_analysis.analyzers.content:analyze_content:158 | Content analysis complete (fallback)
2026-01-15 00:02:43 | INFO     | targeted_analysis.analyzers.strategic:analyze_strategic:32 | === Phase 3C: Strategic Analysis ===
2026-01-15 00:02:43 | INFO     | targeted_analysis.analyzers.strategic:analyze_strategic:148 | Calling Gemini for strategic analysis...
2026-01-15 00:02:56 | WARNING  | targeted_analysis.analyzers.strategic:analyze_strategic:166 | Trying flash model: Loaded cached credentials.
Server 'sequential-thinking' supports tool updates. Listening for changes
2026-01-15 00:03:35 | SUCCESS  | targeted_analysis.analyzers.strategic:analyze_strategic:171 | Strategic analysis complete (fallback)
2026-01-15 00:03:35 | INFO     | targeted_analysis.analyzers.character:analyze_character:32 | === Phase 3D: Character Descriptions ===
2026-01-15 00:03:35 | INFO     | targeted_analysis.analyzers.character:analyze_character:116 | Calling Gemini for character analysis...
2026-01-15 00:03:46 | WARNING  | targeted_analysis.analyzers.character:analyze_character:134 | Trying flash model: Loaded cached credentials.
Server 'context7' supports tool updates. Listening for changes...
Server 
2026-01-15 00:05:39 | SUCCESS  | targeted_analysis.analyzers.character:analyze_character:139 | Character analysis complete (fallback)
2026-01-15 00:05:39 | SUCCESS  | __main__:main:197 | ✅ PHASE 3 COMPLETE - Analysis saved
2026-01-15 00:05:39 | INFO     | targeted_analysis.generators.script_generator:generate_replication_script:32 | === PHASE 4: REPLICATION SCRIPT GENERATION ===
2026-01-15 00:05:39 | INFO     | targeted_analysis.generators.script_generator:generate_replication_script:186 | Calling Gemini for replication script...
2026-01-15 00:05:51 | WARNING  | targeted_analysis.generators.script_generator:generate_replication_script:234 | Trying flash model: Loaded cached credentials.
Server 'context7' supports tool updates. Listening for changes...
Server 
2026-01-15 00:06:44 | SUCCESS  | targeted_analysis.generators.script_generator:generate_replication_script:247 | Replication script generated (fallback)
2026-01-15 00:06:44 | SUCCESS  | targeted_analysis.generators.script_generator:generate_replication_script:248 | ✅ PHASE 4 COMPLETE
2026-01-15 00:06:44 | SUCCESS  | __main__:main:225 | Replication script saved: ../targeted_analysis/20260114/7592606636217257238/replication_script.md
2026-01-15 00:06:44 | INFO     | targeted_analysis.generators.prompt_generator:generate_ai_video_prompts:30 | === PHASE 5: AI VIDEO PROMPTS GENERATION ===
2026-01-15 00:06:44 | INFO     | targeted_analysis.generators.prompt_generator:generate_ai_video_prompts:126 | Calling Gemini for AI video prompts...
2026-01-15 00:06:56 | WARNING  | targeted_analysis.generators.prompt_generator:generate_ai_video_prompts:187 | Trying flash model: Loaded cached credentials.
Server 'filesystem' supports tool updates. Listening for changes...
Serve
2026-01-15 00:07:36 | SUCCESS  | targeted_analysis.generators.prompt_generator:generate_ai_video_prompts:228 | AI video prompts generated (fallback, 5 shots)
2026-01-15 00:07:36 | SUCCESS  | targeted_analysis.generators.prompt_generator:generate_ai_video_prompts:229 | ✅ PHASE 5 COMPLETE
2026-01-15 00:07:36 | SUCCESS  | __main__:main:249 | AI video prompts saved: ../targeted_analysis/20260114/7592606636217257238/ai_video_prompts.md
2026-01-15 00:07:36 | INFO     | __main__:main:257 | ======================================================================
2026-01-15 00:07:36 | SUCCESS  | __main__:main:258 | ✅ ALL PHASES COMPLETE
2026-01-15 00:07:36 | INFO     | __main__:main:259 | ======================================================================
2026-01-15 00:07:36 | INFO     | __main__:main:260 | Output directory: ../targeted_analysis/20260114/7592606636217257238
2026-01-15 00:07:36 | INFO     | __main__:main:261 | Generated files:
2026-01-15 00:07:36 | INFO     | __main__:main:262 |   - metadata.json
2026-01-15 00:07:36 | INFO     | __main__:main:263 |   - video.mp4
2026-01-15 00:07:36 | INFO     | __main__:main:264 |   - frames/ (7 frames)
2026-01-15 00:07:36 | INFO     | __main__:main:265 |   - transcript.json
2026-01-15 00:07:36 | INFO     | __main__:main:266 |   - analysis.md (includes character descriptions)
2026-01-15 00:07:36 | INFO     | __main__:main:267 |   - replication_script.md
2026-01-15 00:07:36 | INFO     | __main__:main:268 |   - ai_video_prompts.md
2026-01-15 00:07:36 | INFO     | __main__:main:269 |   - processing_status.json
2026-01-15 00:07:36 | INFO     | __main__:main:270 |   - analysis.log
2026-01-15 00:07:36 | INFO     | __main__:main:271 | ======================================================================
